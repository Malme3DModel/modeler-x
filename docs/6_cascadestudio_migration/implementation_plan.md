# CascadeStudioå®Œå…¨ã‚³ãƒ”ãƒ¼å®Ÿè£…è¨ˆç”»è©³ç´°

## ğŸŠ **ãƒ•ã‚§ãƒ¼ã‚º7å®Ÿè£…å®Œäº†**ï¼ˆ2025å¹´6æœˆ15æ—¥æ›´æ–°ï¼‰

### âœ… **å®Ÿè£…å®Œäº†é …ç›®**
- âœ… **Golden Layout 2.6.0åŸºç›¤**: V2 APIå®Œå…¨å¯¾å¿œæ¸ˆã¿
- âœ… **CascadeStudioé¢¨ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ**: 3ãƒ‘ãƒãƒ«æ§‹æˆå®Œäº†
- âœ… **ãƒ•ãƒ­ãƒ¼ãƒ†ã‚£ãƒ³ã‚°GUIé…ç½®**: Tweakpaneé ˜åŸŸç¢ºä¿
- âœ… **STARTER_CODEè¡¨ç¤º**: CascadeStudioäº’æ›
- âœ… **ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ãƒ‘ãƒãƒ«**: CascadeStudioé¢¨ãƒ‡ã‚¶ã‚¤ãƒ³
- âœ… **Monaco Editorçµ±åˆ**: F5ã‚­ãƒ¼ã€Ctrl+Sã‚­ãƒ¼ãƒã‚¤ãƒ³ãƒ‰å®Ÿè£…
- âœ… **Monaco Editorãƒ¯ãƒ¼ã‚«ãƒ¼è¨­å®š**: WebWorkerã‚¨ãƒ©ãƒ¼è§£æ±º
- âœ… **URLçŠ¶æ…‹ç®¡ç†ã‚·ã‚¹ãƒ†ãƒ **: Base64ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‰ã«ã‚ˆã‚‹URLå…±æœ‰
- âœ… **CascadeGUIHandlers**: Tweakpane 4.0.1ã«å¯¾å¿œå®Œäº†
- âœ… **Playwrightè‡ªå‹•ãƒ†ã‚¹ãƒˆ**: æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆã¨æ¯”è¼ƒãƒ†ã‚¹ãƒˆå®Ÿè£…
- âœ… **ãƒˆãƒƒãƒ—ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³**: CascadeNavigationå®Ÿè£…å®Œäº†
- âœ… **3Dãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆæ©Ÿèƒ½**: ã‚«ãƒ¡ãƒ©ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ»è¡¨ç¤ºè¨­å®šå®Ÿè£…å®Œäº†
- âœ… **ãƒ•ã‚¡ã‚¤ãƒ«I/Oæ©Ÿèƒ½**: STEP/STL/OBJå¯¾å¿œå®Œäº†

### ğŸ“‹ **ä»Šå¾Œã®æ”¹å–„é …ç›®**
- ğŸ“‹ **ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Š**: ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã¨ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- ğŸ“‹ **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™**: APIä»•æ§˜æ›¸ã¨ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰ä½œæˆ
- ğŸ“‹ **ãƒ†ã‚¹ãƒˆå¼·åŒ–**: å˜ä½“ãƒ†ã‚¹ãƒˆã¨E2Eãƒ†ã‚¹ãƒˆã®è¿½åŠ 

### ğŸš¨ **æ–°ç™ºè¦‹ãƒŠãƒ¬ãƒƒã‚¸**

#### **1. React Three Fiberã«ã‚ˆã‚‹3Dãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆå®Ÿè£…**

React Three Fiber (R3F) ã‚’ä½¿ç”¨ã™ã‚‹ã“ã¨ã§ã€Three.jsã®3Dæç”»èƒ½åŠ›ã¨Reactã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆãƒ¢ãƒ‡ãƒ«ã‚’çµ„ã¿åˆã‚ã›ã‚‹ã“ã¨ãŒã§ãã¾ã—ãŸã€‚ç‰¹ã«é‡è¦ãªå®Ÿè£…ãƒã‚¤ãƒ³ãƒˆã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

```typescript
// components/threejs/CascadeViewport.tsx
function ShapeMesh({ shape, wireframe = false }: ShapeMeshProps) {
  const meshRef = useRef<THREE.Mesh>(null);
  const edgesRef = useRef<THREE.LineSegments>(null);

  useEffect(() => {
    if (!shape) return;

    // ãƒ¡ãƒƒã‚·ãƒ¥ã®è¨­å®š
    if (shape.mesh && meshRef.current) {
      const { vertices, normals, indices } = shape.mesh;
      
      if (vertices && indices) {
        const geometry = new THREE.BufferGeometry();
        geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
        
        if (normals) {
          geometry.setAttribute('normal', new THREE.Float32BufferAttribute(normals, 3));
        } else {
          geometry.computeVertexNormals();
        }
        
        geometry.setIndex(Array.from(indices));
        
        meshRef.current.geometry.dispose();
        meshRef.current.geometry = geometry;
      }
    }

    // ã‚¨ãƒƒã‚¸ã®è¨­å®š
    if (shape.edges && edgesRef.current) {
      const { vertices } = shape.edges;
      
      if (vertices) {
        const geometry = new THREE.BufferGeometry();
        geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));
        
        edgesRef.current.geometry.dispose();
        edgesRef.current.geometry = geometry;
      }
    }
  }, [shape]);

  return (
    <>
      {/* CADãƒ¡ãƒƒã‚·ãƒ¥ */}
      {shape.mesh && (
        <mesh ref={meshRef} castShadow receiveShadow>
          <bufferGeometry />
          <meshStandardMaterial 
            color="#6b9bd7" 
            roughness={0.5} 
            metalness={0.5}
            side={THREE.DoubleSide}
            wireframe={wireframe}
          />
        </mesh>
      )}

      {/* CADã‚¨ãƒƒã‚¸ */}
      {shape.edges && (
        <lineSegments ref={edgesRef}>
          <bufferGeometry />
          <lineBasicMaterial color="#000000" linewidth={1} />
        </lineSegments>
      )}
    </>
  );
}
```

ã“ã®å®Ÿè£…ã«ã‚ˆã‚Šã€OpenCascadeã‹ã‚‰ç”Ÿæˆã•ã‚ŒãŸãƒ¡ãƒƒã‚·ãƒ¥ãƒ‡ãƒ¼ã‚¿ã‚’Three.jsã®ã‚¸ã‚ªãƒ¡ãƒˆãƒªã«å¤‰æ›ã—ã€åŠ¹ç‡çš„ã«ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

#### **2. CascadeNavigationã®å®Ÿè£…ã¨ãƒ¡ãƒ‹ãƒ¥ãƒ¼ç®¡ç†**

ãƒ‰ãƒ­ãƒƒãƒ—ãƒ€ã‚¦ãƒ³ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‚’å«ã‚€ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒãƒ¼ã‚’å®Ÿè£…ã™ã‚‹ã“ã¨ã§ã€CascadeStudioã®æ“ä½œæ€§ã‚’å†ç¾ã—ã¾ã—ãŸï¼š

```typescript
// components/layout/CascadeNavigation.tsx
export default function CascadeNavigation({
  onExport,
  onNewProject,
  onSaveProject,
  onLoadProject,
  onImportFiles,
  onClearImported
}: NavigationProps) {
  return (
    <nav className="flex items-center justify-between p-2 bg-gray-900 text-white shadow-md">
      <div className="flex items-center">
        <h1 className="text-xl font-bold mr-4">Cascade Studio</h1>
        
        {/* ãƒ•ã‚¡ã‚¤ãƒ«ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */}
        <DropdownMenu
          label="File"
          items={[
            { label: 'New Project', onClick: onNewProject || (() => console.log('New Project')) },
            { label: 'Save Project', onClick: onSaveProject || (() => console.log('Save Project')) },
            { label: 'Load Project', onClick: onLoadProject || (() => console.log('Load Project')) },
            { label: 'Import STEP/IGES/STL', onClick: handleFileImport }
          ]}
        />
        
        {/* ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆãƒ¡ãƒ‹ãƒ¥ãƒ¼ */}
        <DropdownMenu
          label="Export"
          items={[
            { label: 'Export STEP', onClick: () => onExport ? onExport('step') : console.log('Export STEP') },
            { label: 'Export STL', onClick: () => onExport ? onExport('stl') : console.log('Export STL') },
            { label: 'Export OBJ', onClick: () => onExport ? onExport('obj') : console.log('Export OBJ') }
          ]}
        />
        
        {/* ç·¨é›†ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */}
        <DropdownMenu
          label="Edit"
          items={[
            { label: 'Clear Imported Files', onClick: onClearImported || (() => console.log('Clear Imported')) }
          ]}
        />
        
        {/* ãƒ˜ãƒ«ãƒ—ãƒ¡ãƒ‹ãƒ¥ãƒ¼ */}
        <DropdownMenu
          label="Help"
          items={[
            { label: 'Documentation', onClick: () => window.open('https://github.com/zalo/CascadeStudio', '_blank') },
            { label: 'About', onClick: () => alert('CascadeStudio - A Full Live-Scripted CAD Kernel in the Browser') }
          ]}
        />
      </div>
    </nav>
  );
}
```

#### **3. Tweakpane 4.0.1ã®APIã®å¤‰æ›´ç‚¹**
Tweakpane 4.0.1ã§ã¯ã€APIãŒå¤§å¹…ã«å¤‰æ›´ã•ã‚Œã¦ã„ã¾ã™ã€‚ä¸»ãªå¤‰æ›´ç‚¹ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

```typescript
// å¾“æ¥ã®Tweakpane
pane.addInput(guiState, 'propertyName', options);

// Tweakpane 4.0.1
pane.addBinding(guiState, 'propertyName', options);
```

ã“ã®å¤‰æ›´ã«å¯¾å¿œã™ã‚‹ãŸã‚ã«ã¯ã€`TweakpaneGUI.tsx`ã¨`CascadeGUIHandlers.ts`ã®ä¸¡æ–¹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã§ã€ã™ã¹ã¦ã®`addInput`ãƒ¡ã‚½ãƒƒãƒ‰ã‚’`addBinding`ã«å¤‰æ›´ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã—ãŸã€‚

#### **4. Monaco Editorã®WebWorkerè¨­å®š**
Monaco Editorã‚’æ­£ã—ãå‹•ä½œã•ã›ã‚‹ã«ã¯ã€å°‚ç”¨ã®WebWorkerã‚’è¨­å®šã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™ã€‚ä»¥ä¸‹ã®ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ãŸå ´åˆï¼š

```
Could not create web worker(s). Falling back to loading web worker code in main thread, which might cause UI freezes.
You must define a function MonacoEnvironment.getWorkerUrl or MonacoEnvironment.getWorker
```

è§£æ±ºæ–¹æ³•ã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ï¼š

1. **MonacoEnvironmentã®è¨­å®š**:
```typescript
// Monaco Editorã®ãƒ¯ãƒ¼ã‚«ãƒ¼è¨­å®š
if (typeof window !== 'undefined') {
  (window as any).MonacoEnvironment = {
    getWorkerUrl: function(_moduleId: string, label: string) {
      if (label === 'typescript' || label === 'javascript') {
        return '/monaco-editor-workers/ts.worker.js';
      }
      return '/monaco-editor-workers/editor.worker.js';
    },
    getWorkerOptions: function() {
      return {
        type: 'classic' // ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã¯importScriptsãŒä½¿ãˆãªã„ãŸã‚classicã‚’ä½¿ç”¨
      };
    }
  };
}
```

## 1. å®Œå…¨çµ±åˆã•ã‚ŒãŸCascadeStudioãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ

```typescript
// components/layout/CascadeStudioLayout.tsx ã®é‡è¦éƒ¨åˆ†
export default function CascadeStudioLayout({ 
  onProjectLoad 
}: CascadeStudioLayoutProps) {
  const containerRef = useRef<HTMLDivElement>(null);
  const layoutRef = useRef<any>(null);
  const [isLayoutReady, setIsLayoutReady] = useState(false);
  const [error, setError] = useState<string | null>(null);
  const [guiState, setGuiState] = useState<GUIState>({});
  const [consoleElement, setConsoleElement] = useState<HTMLElement | null>(null);
  const editorRef = useRef<any>(null);
  const lastSavedCodeRef = useRef<string>(STARTER_CODE);
  const lastSavedGuiStateRef = useRef<GUIState>({});

  // CADãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ•ãƒƒã‚¯ã‚’è¿½åŠ 
  const {
    isWorkerReady,
    isWorking,
    shapes,
    logs,
    error: workerError,
    executeCADCode,
    combineAndRender,
    worker
  } = useCADWorker();

  // URLãƒãƒƒã‚·ãƒ¥ã‹ã‚‰åˆæœŸçŠ¶æ…‹ã‚’èª­ã¿è¾¼ã‚€
  useEffect(() => {
    if (typeof window === 'undefined') return;
    
    try {
      const urlState = URLStateManager.getStateFromURL();
      
      // ã‚³ãƒ¼ãƒ‰çŠ¶æ…‹ãŒã‚ã‚Œã°ä½¿ç”¨
      if (urlState.code) {
        lastSavedCodeRef.current = urlState.code;
        appendConsoleMessage('ğŸ”— URLã‹ã‚‰åˆæœŸã‚³ãƒ¼ãƒ‰ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'info');
      }
      
      // GUIçŠ¶æ…‹ãŒã‚ã‚Œã°ä½¿ç”¨
      if (urlState.guiState) {
        setGuiState(urlState.guiState);
        lastSavedGuiStateRef.current = urlState.guiState;
        appendConsoleMessage('ğŸ”— URLã‹ã‚‰GUIçŠ¶æ…‹ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'info');
      }
    } catch (error) {
      console.error('URLçŠ¶æ…‹ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—:', error);
      appendConsoleMessage('âš ï¸ URLçŠ¶æ…‹ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
    }
  }, []);

  return (
    <div className="h-full w-full">
      <CascadeNavigation 
        onNewProject={() => {
          // ã‚¨ãƒ‡ã‚£ã‚¿ãŒåˆ©ç”¨å¯èƒ½ãªã‚‰ã‚³ãƒ¼ãƒ‰ã‚’ãƒªã‚»ãƒƒãƒˆ
          if (editorRef.current) {
            editorRef.current.setValue(STARTER_CODE);
            lastSavedCodeRef.current = STARTER_CODE;
            evaluateCode(STARTER_CODE);
          }
          appendConsoleMessage('ğŸ†• æ–°è¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆã—ã¾ã—ãŸ', 'info');
        }}
        onSaveProject={() => {
          if (editorRef.current) {
            const code = editorRef.current.getValue();
            const projectData = {
              code,
              guiState
            };
            // JSONã¨ã—ã¦ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆ
            const projectString = JSON.stringify(projectData, null, 2);
            const blob = new Blob([projectString], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'cascade-project.json';
            link.click();
            URL.revokeObjectURL(url);
            appendConsoleMessage('ğŸ’¾ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’JSONã¨ã—ã¦ä¿å­˜ã—ã¾ã—ãŸ', 'success');
          }
        }}
        onLoadProject={() => {
          const input = document.createElement('input');
          input.type = 'file';
          input.accept = 'application/json';
          input.onchange = (e: any) => {
            const file = e.target.files?.[0];
            if (file) {
              const reader = new FileReader();
              reader.onload = (event) => {
                try {
                  const projectData = JSON.parse(event.target?.result as string);
                  if (projectData.code && editorRef.current) {
                    editorRef.current.setValue(projectData.code);
                    lastSavedCodeRef.current = projectData.code;
                    
                    // GUIã‚¹ãƒ†ãƒ¼ãƒˆãŒã‚ã‚Œã°æ›´æ–°
                    if (projectData.guiState) {
                      setGuiState(projectData.guiState);
                      lastSavedGuiStateRef.current = projectData.guiState;
                    }
                    
                    // ã‚³ãƒ¼ãƒ‰ã‚’è©•ä¾¡
                    evaluateCode(projectData.code);
                    appendConsoleMessage('ğŸ“‚ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ', 'success');
                  }
                } catch (error) {
                  appendConsoleMessage('âš ï¸ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®èª­ã¿è¾¼ã¿ã«å¤±æ•—: ' + (error instanceof Error ? error.message : String(error)), 'error');
                }
              };
              reader.readAsText(file);
            }
          };
          input.click();
        }}
        onExport={(format) => {
          if (!worker) {
            appendConsoleMessage('âŒ ãƒ¯ãƒ¼ã‚«ãƒ¼ãŒåˆæœŸåŒ–ã•ã‚Œã¦ã„ã¾ã›ã‚“', 'error');
            return;
          }
          
          switch (format) {
            case 'step':
              worker.postMessage({ type: 'saveShapeSTEP' });
              appendConsoleMessage('ğŸ”„ STEPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™...', 'info');
              break;
            case 'stl':
              worker.postMessage({ type: 'saveShapeSTL' });
              appendConsoleMessage('ğŸ”„ STLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™...', 'info');
              break;
            case 'obj':
              worker.postMessage({ type: 'saveShapeOBJ' });
              appendConsoleMessage('ğŸ”„ OBJãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™...', 'info');
              break;
          }
        }}
        onImportFiles={() => {
          const input = document.createElement('input');
          input.type = 'file';
          input.accept = '.step,.stp,.iges,.igs,.stl';
          input.multiple = true;
          input.onchange = (e: any) => {
            const files = e.target.files;
            if (files && files.length > 0 && worker) {
              appendConsoleMessage(`ğŸ“ ${files.length}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã™...`, 'info');
              worker.postMessage({ 
                type: 'loadFiles', 
                payload: Array.from(files)
              });
            }
          };
          input.click();
        }}
        onClearImported={() => {
          if (worker) {
            worker.postMessage({ type: 'clearExternalFiles' });
            appendConsoleMessage('ğŸ§¹ ã‚¤ãƒ³ãƒãƒ¼ãƒˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ', 'info');
          }
        }}
      />
      <div ref={containerRef} className="h-full w-full" />
    </div>
  );
}
```

## 2. React Three Fiberå®Ÿè£…

### 2.1 CascadeViewport.tsx

```typescript
// components/threejs/CascadeViewport.tsx ã®ä¸»è¦éƒ¨åˆ†
export default function CascadeViewport({ 
  shapes = [], 
  viewSettings = {}
}: CascadeViewportProps) {
  // useViewSettingsãƒ•ãƒƒã‚¯ã‚’ä½¿ç”¨ã—ã¦è¨­å®šç®¡ç†
  const { viewSettings: currentSettings, updateSetting, toggleSetting } = 
    useViewSettings({...defaultViewSettings, ...viewSettings});
  
  // ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ è¡¨ç¤ºåˆ‡æ›¿ã®ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
  const toggleWireframe = () => toggleSetting('wireframe');
  
  // ã‚·ãƒ£ãƒ‰ã‚¦è¡¨ç¤ºåˆ‡æ›¿ã®ãƒãƒ³ãƒ‰ãƒ©ãƒ¼
  const toggleShadows = () => toggleSetting('shadows');

  return (
    <div style={{ width: '100%', height: '100%', position: 'relative' }}>
      {/* ãƒ“ãƒ¥ãƒ¼ãƒãƒ¼ãƒˆè¨­å®šã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ãƒ‘ãƒãƒ« */}
      <div className="absolute bottom-2 left-2 z-10 bg-gray-800 bg-opacity-80 p-1 rounded shadow-lg text-white text-sm">
        <label className="flex items-center mb-1">
          <input 
            type="checkbox" 
            checked={currentSettings.wireframe} 
            onChange={toggleWireframe}
            className="mr-2"
          />
          ãƒ¯ã‚¤ãƒ¤ãƒ¼ãƒ•ãƒ¬ãƒ¼ãƒ 
        </label>
        <label className="flex items-center">
          <input 
            type="checkbox" 
            checked={currentSettings.shadows} 
            onChange={toggleShadows}
            className="mr-2"
          />
          ã‚·ãƒ£ãƒ‰ã‚¦
        </label>
      </div>

      <Canvas 
        shadows={currentSettings.shadows} 
        gl={{ antialias: true }}
        style={{ background: currentSettings.backgroundColor }}
      >
        <SceneSetup viewSettings={currentSettings} />
        
        {/* CADã‚·ã‚§ã‚¤ãƒ—ã‚’è¡¨ç¤º */}
        {shapes.map((shape, i) => (
          <ShapeMesh 
            key={i} 
            shape={shape} 
            wireframe={currentSettings.wireframe} 
          />
        ))}
      </Canvas>
    </div>
  );
}
```

## 3. ãƒ•ã‚¡ã‚¤ãƒ«I/Oå®Ÿè£…

```typescript
// ãƒ¯ãƒ¼ã‚«ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’è¿½åŠ 
useEffect(() => {
  if (!worker || !isWorkerReady) return;

  // STEPãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå‡¦ç†
  const handleSaveShapeSTEP = (e: MessageEvent) => {
    if (e.data.type === 'saveShapeSTEP' && e.data.payload) {
      const stepContent = e.data.payload;
      const blob = new Blob([stepContent], { type: 'model/step' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'cascade-model.step';
      link.click();
      URL.revokeObjectURL(url);
      appendConsoleMessage('âœ… STEPãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
    }
  };

  // STLãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå‡¦ç†
  const handleSaveShapeSTL = (e: MessageEvent) => {
    if (e.data.type === 'saveShapeSTL' && e.data.payload) {
      const stlContent = e.data.payload;
      const blob = new Blob([stlContent], { type: 'model/stl' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'cascade-model.stl';
      link.click();
      URL.revokeObjectURL(url);
      appendConsoleMessage('âœ… STLãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
    }
  };

  // OBJãƒ•ã‚¡ã‚¤ãƒ«ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆå‡¦ç†
  const handleSaveShapeOBJ = (e: MessageEvent) => {
    if (e.data.type === 'saveShapeOBJ' && e.data.payload) {
      const objContent = e.data.payload;
      const blob = new Blob([objContent], { type: 'model/obj' });
      const url = URL.createObjectURL(blob);
      const link = document.createElement('a');
      link.href = url;
      link.download = 'cascade-model.obj';
      link.click();
      URL.revokeObjectURL(url);
      appendConsoleMessage('âœ… OBJãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ', 'success');
    }
  };

  // ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å‡¦ç†
  const handleLoadFiles = (e: MessageEvent) => {
    if (e.data.type === 'loadFiles' && e.data.payload) {
      appendConsoleMessage(`âœ… ${Object.keys(e.data.payload).length}å€‹ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆã—ã¾ã—ãŸ`, 'success');
    }
  };

  // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã‚’ç™»éŒ²
  worker.addEventListener('message', handleSaveShapeSTEP);
  worker.addEventListener('message', handleSaveShapeSTL);
  worker.addEventListener('message', handleSaveShapeOBJ);
  worker.addEventListener('message', handleLoadFiles);

  // ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
  return () => {
    worker.removeEventListener('message', handleSaveShapeSTEP);
    worker.removeEventListener('message', handleSaveShapeSTL);
    worker.removeEventListener('message', handleSaveShapeOBJ);
    worker.removeEventListener('message', handleLoadFiles);
  };
}, [worker, isWorkerReady]);
```

## 4. ä»Šå¾Œã®æ”¹å–„è¨ˆç”»

### 4.1 ã‚³ãƒ¼ãƒ‰å“è³ªå‘ä¸Šï¼ˆ2025å¹´6æœˆ16æ—¥ã€œ22æ—¥ï¼‰

- **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆåˆ†å‰²ã¨ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯æœ€é©åŒ–
- **å‹å®‰å…¨æ€§ã®å¼·åŒ–**: å³æ ¼ãªTypeScriptå‹å®šç¾©ã®é©ç”¨
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–**: ãƒ¬ãƒ³ãƒ€ãƒªãƒ³ã‚°ã¨ãƒ¡ãƒ¢ãƒªä½¿ç”¨ã®æœ€é©åŒ–
- **ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°**: ã‚¨ãƒ©ãƒ¼æ•æ‰ã¨å›å¾©ãƒ¡ã‚«ãƒ‹ã‚ºãƒ ã®æ”¹å–„

### 4.2 ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ï¼ˆ2025å¹´6æœˆ23æ—¥ã€œ29æ—¥ï¼‰

- **APIä»•æ§˜æ›¸**: ä¸»è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¨ãƒ•ãƒƒã‚¯ã®APIä»•æ§˜æ›¸ä½œæˆ
- **ä½¿ã„æ–¹ã‚¬ã‚¤ãƒ‰**: ã‚¨ãƒ³ãƒ‰ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ
- **é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰**: æ‹¡å¼µé–‹ç™ºè€…å‘ã‘ã‚¬ã‚¤ãƒ‰ä½œæˆ
- **ã‚µãƒ³ãƒ—ãƒ«ã‚³ãƒ¼ãƒ‰**: ä¸€èˆ¬çš„ãªãƒ¦ãƒ¼ã‚¹ã‚±ãƒ¼ã‚¹ã®ã‚µãƒ³ãƒ—ãƒ«ä½œæˆ

### 4.3 ãƒ†ã‚¹ãƒˆå¼·åŒ–ï¼ˆ2025å¹´6æœˆ30æ—¥ã€œ7æœˆ6æ—¥ï¼‰

- **å˜ä½“ãƒ†ã‚¹ãƒˆ**: é‡è¦ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã®å˜ä½“ãƒ†ã‚¹ãƒˆè¿½åŠ 
- **çµ±åˆãƒ†ã‚¹ãƒˆ**: ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆé–“é€£æºãƒ†ã‚¹ãƒˆè¿½åŠ 
- **E2Eãƒ†ã‚¹ãƒˆ**: Playwrightã«ã‚ˆã‚‹ã‚¨ãƒ³ãƒ‰ãƒ„ãƒ¼ã‚¨ãƒ³ãƒ‰ãƒ†ã‚¹ãƒˆå¼·åŒ–
- **ã‚¯ãƒ­ã‚¹ãƒ–ãƒ©ã‚¦ã‚¶äº’æ›æ€§**: ä¸»è¦ãƒ–ãƒ©ã‚¦ã‚¶ã§ã®å‹•ä½œæ¤œè¨¼

### 4.4 æœ€çµ‚ãƒªãƒªãƒ¼ã‚¹æº–å‚™ï¼ˆ2025å¹´7æœˆ7æ—¥ã€œ13æ—¥ï¼‰

- **æœ€çµ‚ãƒã‚°ä¿®æ­£**: æ®‹å­˜ãƒã‚°ã®ä¿®æ­£
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒãƒ¥ãƒ¼ãƒ‹ãƒ³ã‚°**: æœ€çµ‚çš„ãªãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
- **ãƒ‡ãƒ¢æº–å‚™**: ãƒ‡ãƒ¢ãƒšãƒ¼ã‚¸ã¨ã‚µãƒ³ãƒ—ãƒ«ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆä½œæˆ
- **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæœ€çµ‚åŒ–**: ã™ã¹ã¦ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®æœ€çµ‚ç¢ºèªã¨æ›´æ–°

## 5. å®Œäº†äºˆå®š

**ãƒªãƒªãƒ¼ã‚¹äºˆå®šæ—¥**: 2025å¹´7æœˆ15æ—¥

æ¬¡æœŸãƒ•ã‚§ãƒ¼ã‚ºã§ã¯ã€ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆæ•´å‚™ã¨å“è³ªå‘ä¸Šã«æ³¨åŠ›ã—ã¾ã™ã€‚CascadeStudioã®åŸºæœ¬æ©Ÿèƒ½ã®å®Œå…¨å†ç¾ã¯é”æˆã—ãŸãŸã‚ã€æ¬¡ã¯ä½¿ã„ã‚„ã™ã•ã¨æ‹¡å¼µæ€§ã®å‘ä¸Šã«é‡ç‚¹ã‚’ç½®ãã¾ã™ã€‚ 