# AIコード実行機能 - ユーザーガイド

## はじめに

Modeler-XのAIコード実行機能へようこそ！この機能を使用すると、自然言語でCADモデリングを依頼し、生成されたコードをワンクリックで実行できます。プログラミングの知識がなくても、直感的に3Dモデルを作成できます。

## 基本的な使い方

### 1. チャットパネルを開く

アプリケーションの右側にあるチャットパネルを確認してください。ここでAIとの対話を行います。

### 2. 質問を入力する

テキストボックスに自然言語で質問を入力します。

**例：**
```
「半径30の球体を作成してください」
「箱と円柱を組み合わせた形状を作って」
「歯車のような形状を作成してください」
```

### 3. AIの回答を確認する

AIが回答を生成し、実行可能なコードが含まれている場合は、専用のコードブロックが表示されます。

### 4. コードを実行する

コードブロックの右上にある緑色の「実行」ボタンをクリックすると、コードがMonacoEditorに設定され、自動的に実行されます。

### 5. 結果を確認する

3Dビューに生成された形状が表示されます。

## 効果的な質問の仕方

### 基本的な形状

#### 単純な形状
```
「立方体を作成してください」
「半径20の球体を作って」
「高さ50、半径15の円柱を作成して」
```

#### サイズを指定した形状
```
「幅50、高さ30、奥行き20の箱を作って」
「底面半径30、上面半径10、高さ40の円錐を作成して」
```

### 複合的な形状

#### 複数の形状を組み合わせ
```
「球体の上に円柱を配置した形状を作って」
「立方体から球体を引いた形状を作成して」
「3つの円柱を結合した形状を作って」
```

#### 変形操作
```
「箱を45度回転させてください」
「球体を[10, 20, 30]の位置に移動して」
「円柱を2倍に拡大してください」
```

### 高度な形状

#### 押し出しや回転
```
「三角形を高さ50で押し出した形状を作って」
「円を軸周りに回転させて球体を作成して」
```

#### フィレットや面取り
```
「立方体の角を半径5でフィレットして」
「箱の辺を距離3で面取りして」
```

## 利用可能な機能

### 基本形状

| 関数 | 説明 | 例 |
|------|------|-----|
| `Box(幅, 高さ, 奥行き)` | 直方体 | `Box(50, 30, 20)` |
| `Sphere(半径)` | 球体 | `Sphere(25)` |
| `Cylinder(半径, 高さ)` | 円柱 | `Cylinder(15, 50)` |
| `Cone(下半径, 上半径, 高さ)` | 円錐 | `Cone(20, 5, 30)` |

### 変形操作

| 関数 | 説明 | 例 |
|------|------|-----|
| `Translate([x, y, z], 形状)` | 移動 | `Translate([10, 0, 20], box)` |
| `Rotate([軸x, 軸y, 軸z], 角度, 形状)` | 回転 | `Rotate([0, 0, 1], 45, box)` |
| `Scale(倍率, 形状)` | 拡大縮小 | `Scale(2, sphere)` |

### ブール演算

| 関数 | 説明 | 例 |
|------|------|-----|
| `Union([形状1, 形状2, ...])` | 結合 | `Union([box, sphere])` |
| `Difference(基本形状, [引く形状])` | 差分 | `Difference(box, [sphere])` |
| `Intersection([形状1, 形状2, ...])` | 交差 | `Intersection([box, sphere])` |

### 高度な操作

| 関数 | 説明 | 例 |
|------|------|-----|
| `Extrude(プロファイル, 高さ)` | 押し出し | `Extrude(triangle, 50)` |
| `Revolve(形状, 角度)` | 回転体 | `Revolve(profile, 360)` |
| `FilletEdges(形状, 半径, [辺])` | フィレット | `FilletEdges(box, 5)` |

## 実用的な例

### 例1: 基本的なボルト

**質問：**
```
「ボルトのような形状を作成してください。頭部は六角形で、軸は円柱です」
```

**生成されるコード：**
```typescript
// ボルトの軸を作成
let shaft = Cylinder(5, 40);

// 六角形の頭部を作成
let hexPoints = [];
for (let i = 0; i < 6; i++) {
  let angle = (i * 60) * Math.PI / 180;
  let x = 12 * Math.cos(angle);
  let y = 12 * Math.sin(angle);
  hexPoints.push([x, y, 0]);
}
let hexProfile = Polygon(hexPoints);
let head = Extrude(hexProfile, 8);

// 頭部を軸の上に移動
let movedHead = Translate([0, 0, 20], head);

// ボルトを組み立て
let bolt = Union([shaft, movedHead]);
sceneShapes.push(bolt);
```

### 例2: 歯車

**質問：**
```
「8つの歯を持つ歯車を作成してください」
```

**生成されるコード：**
```typescript
// 基本の円盤
let baseDisk = Cylinder(30, 8, true);

// 中心の穴
let centerHole = Cylinder(8, 10, true);

// 歯を作成
let teeth = [];
for (let i = 0; i < 8; i++) {
  let angle = (i * 45);
  let tooth = Box(6, 12, 8, true);
  let rotatedTooth = Rotate([0, 0, 1], angle, tooth);
  let movedTooth = Translate([35, 0, 0], rotatedTooth);
  teeth.push(movedTooth);
}

// 全ての歯を結合
let allTeeth = Union(teeth);

// 歯車を組み立て
let gearWithTeeth = Union([baseDisk, allTeeth]);
let gear = Difference(gearWithTeeth, [centerHole]);

sceneShapes.push(gear);
```

### 例3: 建築的な形状

**質問：**
```
「アーチ型の窓がある壁を作成してください」
```

**生成されるコード：**
```typescript
// 基本の壁
let wall = Box(200, 20, 150);

// アーチ型の窓を作成
let windowBase = Box(60, 25, 80);
let windowTop = Cylinder(30, 25);
let rotatedTop = Rotate([1, 0, 0], 90, windowTop);
let movedTop = Translate([0, 0, 40], rotatedTop);
let window = Union([windowBase, movedTop]);

// 窓を壁の中央に配置
let centeredWindow = Translate([0, 0, 35], window);

// 壁から窓を引く
let wallWithWindow = Difference(wall, [centeredWindow]);

sceneShapes.push(wallWithWindow);
```

## トラブルシューティング

### よくある問題と解決方法

#### 1. 実行ボタンが表示されない

**原因：** AIの回答にコードブロックが含まれていない

**解決方法：**
- より具体的な質問をする
- 「TypeScriptコードで」と明示的に指定する
- 例：「TypeScriptコードで立方体を作成してください」

#### 2. コードが実行されない

**原因：** MonacoEditorが初期化されていない

**解決方法：**
- ページを再読み込みする
- エディターが完全に読み込まれるまで待つ

#### 3. 形状が表示されない

**原因：** コードにエラーがある、または`sceneShapes.push()`が抜けている

**解決方法：**
- コンソールでエラーを確認する
- コードを手動でエディターにコピーして実行する
- AIに「sceneShapes.push()を忘れずに」と指示する

#### 4. 期待した形状と違う

**原因：** 質問が曖昧、またはパラメータが不適切

**解決方法：**
- より詳細な寸法や仕様を指定する
- 「修正してください」と追加で依頼する
- 具体的な数値を指定する

### エラーメッセージの対処法

#### "MonacoEditorが初期化されていません"
- ページの読み込み完了を待つ
- ブラウザを再起動する

#### "API使用量の制限に達しました"
- しばらく時間を置いてから再試行する
- 質問を短くして送信する

#### "TypeScript構文エラー"
- 生成されたコードを手動で修正する
- AIに「構文エラーを修正してください」と依頼する

## 高度な使用方法

### パラメータ化された形状

**質問：**
```
「スライダーで半径を調整できる球体を作成してください」
```

**生成されるコード：**
```typescript
// スライダーで半径を制御
let radius = Slider("球体の半径", 25, 10, 50);

// 球体を作成
let sphere = Sphere(radius);
sceneShapes.push(sphere);
```

### 複数のGUI要素

**質問：**
```
「チェックボックスで表示/非表示を切り替えられる箱を作成してください」
```

**生成されるコード：**
```typescript
// チェックボックスで表示制御
let showBox = Checkbox("箱を表示", true);

if (showBox) {
  let box = Box(30, 30, 30);
  sceneShapes.push(box);
}
```

### アニメーション的な効果

**質問：**
```
「スライダーで回転角度を制御できる立方体を作成してください」
```

**生成されるコード：**
```typescript
// 回転角度をスライダーで制御
let rotationAngle = Slider("回転角度", 0, 0, 360);

// 立方体を作成して回転
let box = Box(40, 40, 40);
let rotatedBox = Rotate([0, 0, 1], rotationAngle, box);

sceneShapes.push(rotatedBox);
```

## ベストプラクティス

### 効果的な質問のコツ

1. **具体的な寸法を指定する**
   - ❌ 「大きな箱を作って」
   - ✅ 「幅100、高さ50、奥行き30の箱を作って」

2. **段階的に複雑にする**
   - まず基本形状を作成
   - 次に変形や組み合わせを依頼

3. **視覚的な説明を加える**
   - 「ドーナツのような形状」
   - 「建物の柱のような円柱」

4. **エラーが出たら詳細を伝える**
   - 「先ほどのコードでエラーが出ました。修正してください」

### コードの理解を深める

生成されたコードを読んで、以下を理解しましょう：

1. **関数の役割**
   - どの関数が何をしているか
   - パラメータの意味

2. **座標系**
   - X, Y, Z軸の方向
   - 移動や回転の基準点

3. **形状の組み合わせ方**
   - Union（結合）の使い方
   - Difference（差分）の使い方

## まとめ

AIコード実行機能を使用することで、プログラミングの知識がなくても複雑な3Dモデルを作成できます。最初は簡単な形状から始めて、徐々に複雑な形状に挑戦してみてください。

何か問題が発生した場合は、このガイドのトラブルシューティングセクションを参照するか、より具体的な質問をAIに投げかけてみてください。

楽しいCADモデリングをお楽しみください！ 